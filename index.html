<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Ember Ledger</title>
  <meta name="description" content="A tiny fantasy-themed website with a quest board, dice roller, name forge, and more. Perfect for GitHub Pages." />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&family=Spectral:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <!-- Favicon (inline SVG) -->
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path fill="%23c084fc" d="M64 8c8 24 28 26 28 48 0 18-14 32-28 48C50 88 36 74 36 56c0-22 20-24 28-48z"/></svg>' />
  <style>
    :root {
      --bg: #0b0e14;
      --fg: #e8e6df;
      --muted: #b2b6c0;
      --accent: #c084fc;
      --card: rgba(255,255,255,.06);
      --border: rgba(255,255,255,.12);
      --glow: rgba(192,132,252,.5);
    }
    .light {
      --bg: #f8f7f3;
      --fg: #1d1c1a;
      --muted: #5a5e66;
      --card: rgba(0,0,0,.04);
      --border: rgba(0,0,0,.08);
      --glow: rgba(147,197,253,.5);
    }
    * { box-sizing: border-box }
    body { margin:0; font-family: 'Spectral', system-ui, serif; background: var(--bg); color: var(--fg); line-height:1.6; }
    header { position:sticky; top:0; backdrop-filter:saturate(1.2) blur(6px); background: linear-gradient( to right, rgba(0,0,0,.3), rgba(0,0,0,.1) ); border-bottom:1px solid var(--border); z-index:10; }
    .container { max-width: 1050px; padding: 1rem; margin: 0 auto; }
    .brand { font-family:'UnifrakturMaguntia', cursive; font-size: clamp(1.3rem, 2vw + 1rem, 2.1rem); letter-spacing:.5px }
    nav a { margin-right:1rem; text-decoration:none; color:var(--fg); opacity: .85 }
    nav a:hover { opacity:1; text-decoration: underline; text-underline-offset: 4px}
    .hero { position: relative; padding: 6rem 0 4rem; overflow:hidden; border-bottom:1px solid var(--border); }
    .hero h1 { font-family:'UnifrakturMaguntia', cursive; font-size: clamp(2rem, 5vw + 1rem, 4rem); margin:0 0 0.5rem }
    .hero p { max-width: 60ch; opacity:.9 }
    .button { display:inline-block; padding:.7rem 1rem; border-radius: 999px; border:1px solid var(--border); background: linear-gradient(180deg, var(--card), transparent); cursor:pointer; color:var(--fg); text-decoration:none; box-shadow: 0 0 0 .5px var(--border), 0 10px 25px -15px var(--glow); }
    .button:hover { transform: translateY(-1px) }
    .grid { display:grid; gap:1rem }
    @media (min-width: 768px) { .grid-2 { grid-template-columns: 1fr 1fr } .grid-3 { grid-template-columns: repeat(3,1fr) } }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding:1rem; box-shadow: 0 10px 30px -20px rgba(0,0,0,.5) }
    .card h3 { margin:.2rem 0 .6rem }
    label { display:block; font-weight:600; margin:.5rem 0 .2rem }
    input[type="text"], input[type="number"], select { width:100%; padding:.6rem .7rem; border-radius:12px; border:1px solid var(--border); background: transparent; color:var(--fg) }
    hr.sep { border:0; height:1px; background: var(--border); margin: 2rem 0 }
    footer { border-top:1px solid var(--border); padding: 2rem 0; margin-top: 2rem }
    small.muted { color: var(--muted) }
    .switch { display:inline-flex; align-items:center; gap:.5rem }
    .switch input { appearance: none; width:46px; height:26px; background: var(--card); border:1px solid var(--border); border-radius:999px; position: relative; cursor:pointer }
    .switch input::after { content:''; position:absolute; top:2px; left:2px; width:20px;height:20px;border-radius:50%; background: var(--fg); transition: transform .2s }
    .switch input:checked::after { transform: translateX(20px) }
    #sky, #fog { position:absolute; inset:0; z-index:-1; }
    #sky { background: radial-gradient(600px 300px at 50% -10%, rgba(255,255,255,.15), transparent), radial-gradient(800px 400px at 10% 10%, rgba(192,132,252,.15), transparent), radial-gradient(800px 400px at 90% 15%, rgba(96,165,250,.12), transparent); }
    #fog { background: radial-gradient(700px 200px at 30% 120%, rgba(255,255,255,.06), transparent), radial-gradient(700px 200px at 70% 120%, rgba(255,255,255,.06), transparent); filter: blur(10px); animation: drift 20s linear infinite alternate }
    @keyframes drift { to { transform: translateY(20px) } }
    kbd { border:1px solid var(--border); border-radius:6px; padding:0 .3rem; background: var(--card); }
    .visually-hidden { position:absolute !important; clip: rect(1px,1px,1px,1px); padding:0 !important; border:0 !important; height:1px !important; width:1px !important; overflow:hidden }
    .flash { box-shadow: 0 0 0 2px var(--glow) inset }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="grid grid-2" style="align-items:center">
        <div class="brand">The Ember Ledger</div>
        <nav style="justify-self:end">
          <a href="#quests">Quests</a>
          <a href="#dice">Dice</a>
          <a href="#names">Name Forge</a>
          <a href="#backstory">Backstory</a>
          <a href="#map">Map</a>
          <span class="switch" aria-label="Toggle day/night theme"><input id="themeToggle" type="checkbox" role="switch" aria-checked="false" aria-label="Toggle theme"><label for="themeToggle" class="visually-hidden">Theme</label></span>
        </nav>
      </div>
    </div>
  </header>

  <section class="hero">
    <div id="sky"></div><div id="fog"></div>
    <div class="container">
      <h1>Welcome, traveler.</h1>
      <p>Behold a tiny, hand‚Äëforged fantasy site: a quest board you can edit, a dice roller for fate, a forge for names, and a pocket map of places. It‚Äôs all one file‚Äîeasy to tweak and perfect for GitHub Pages.</p>
      <a class="button" href="#quests">Begin your quest</a>
    </div>
  </section>

  <main class="container">
    <section id="quests" class="grid grid-2">
      <div class="card">
        <h3>Quest Board</h3>
        <p class="muted">üîß <em>Edit these directly in the HTML‚Äîlook for the <code>&lt;ul id="questList"&gt;</code> below.</em></p>
        <label for="questSearch">Search</label>
        <input id="questSearch" type="text" placeholder="Type to filter quests‚Ä¶ (e.g., dragon, ruins)">
        <ul id="questList">
          <li class="quest-card">Investigate the <strong>whispering ruins</strong> by the moonlit fen.</li>
          <li class="quest-card">Broker peace between the <strong>Ember Guild</strong> and the river wardens.</li>
          <li class="quest-card">Recover the <strong>Obsidian Keystone</strong> from the ash tunnels.</li>
          <li class="quest-card">Escort a caravan through the <strong>Wyrmwood</strong> after sundown.</li>
        </ul>
        <div style="display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.8rem">
          <button class="button" id="genQuest">Generate random quest (web)</button>
          <button class="button" id="genQuest3">Generate 3</button>
          <small class="muted">Powered by Open5e monsters.</small>
        </div>
      </div>
      <div class="card">
        <h3>Tips</h3>
        <ul>
          <li><strong>Change the title</strong>: edit the text ‚ÄúThe Ember Ledger‚Äù in the header.</li>
          <li><strong>Add a quest</strong>: copy a <code>&lt;li class="quest-card"&gt;‚Ä¶&lt;/li&gt;</code> and edit the text.</li>
          <li><strong>Colors</strong>: tweak the CSS variables at the top of the file.</li>
        </ul>
      </div>
    </section>

    <hr class="sep">

    <section id="dice" class="grid grid-2">
      <div class="card">
        <h3>Dice Roller</h3>
        <div style="display:flex; gap:.5rem; flex-wrap: wrap; margin:.5rem 0">
          <button class="button die" data-sides="4">d4</button>
          <button class="button die" data-sides="6">d6</button>
          <button class="button die" data-sides="8">d8</button>
          <button class="button die" data-sides="10">d10</button>
          <button class="button die" data-sides="12">d12</button>
          <button class="button die" data-sides="20">d20</button>
          <button class="button die" data-sides="100">d100</button>
        </div>
        <label for="diceCount">Number of dice</label>
        <input id="diceCount" type="number" min="1" max="20" value="1">
        <label for="diceSides">Custom sides (optional)</label>
        <input id="diceSides" type="number" min="2" max="1000" placeholder="e.g., 7">
        <div aria-live="polite" id="diceOutput" style="margin-top:.8rem"></div>
      </div>
      <div class="card">
        <h3>Shortcuts</h3>
        <p>Press <kbd>1</kbd>..<kbd>7</kbd> to roll d4/d6/d8/d10/d12/d20/d100 quickly.</p>
        <p><em>The last total is stored so you can compare rolls.</em></p>
      </div>
    </section>

    <hr class="sep">

    <section id="names" class="grid grid-2">
      <div class="card">
        <h3>Name Forge</h3>
        <label for="raceSelect">Style</label>
        <select id="raceSelect" aria-label="Select name style">
          <option value="elf">Elf</option>
          <option value="dwarf">Dwarf</option>
          <option value="human">Human</option>
          <option value="lizardfolk">Lizardfolk</option>
        </select>
        <button class="button" id="genName" style="margin-top:.6rem">Forge Name</button>
        <button class="button" id="genNameApi" style="margin-top:.6rem; margin-left:.4rem">Forge via API (web)</button>
        <small class="muted">Uses fantasyname.lukewh.com; falls back to local if offline.</small>
        <div id="nameOut" aria-live="polite" style="margin-top: .8rem; font-size:1.25rem"></div>
      </div>
      <div class="card">
        <h3>How to customize</h3>
        <p>Open the script at the bottom of this file and add or remove names in the arrays.</p>
      </div>
    </section>

    <hr class="sep">

    <section id="backstory" class="grid grid-2">
      <div class="card">
        <h3>Backstory Forge</h3>
        <p class="muted">Pick a race and class. We'll pull a random <em>Background</em> and prompts from the Open5e API and stitch a seed idea.</p>
        <label for="backRace">Race</label>
        <select id="backRace">
          <option>Human</option><option>Elf</option><option>Dwarf</option><option>Orc</option><option>Lizardfolk</option>
        </select>
        <label for="backClass">Class</label>
        <select id="backClass">
          <option>Barbarian</option><option>Bard</option><option>Cleric</option><option>Druid</option><option>Fighter</option><option>Monk</option><option>Paladin</option><option>Ranger</option><option>Rogue</option><option>Sorcerer</option><option>Warlock</option><option>Wizard</option>
        </select>
        <button class="button" id="genBack" style="margin-top:.6rem">Forge Backstory (web)</button>
        <div id="backOut" aria-live="polite" style="margin-top:.8rem"></div>
        <small class="muted">Powered by <a href="https://open5e.com/api-docs" target="_blank" rel="noopener">Open5e</a>. No account needed.</small>
      </div>
      <div class="card">
        <h3>What it makes</h3>
        <p>One‚Äëparagraph hooks using a random background's connections and mementos‚Äîgreat for kickstarting a character or NPC.</p>
      </div>
    </section>

    <hr class="sep">

    <section id="map" class="grid grid-2">
      <div class="card">
        <h3>Pocket Map</h3>
        <details open>
          <summary>üïØÔ∏è The Lantern Market</summary>
          A tangle of alleys where glassblowers sell bottled starlight.
        </details>
        <details>
          <summary>üçÉ Wyrmwood Edge</summary>
          Owls whisper warnings. Travelers leave offerings of copper.
        </details>
        <details>
          <summary>‚õ∞Ô∏è The Ash Tunnels</summary>
          Lava‚Äëscarred caverns where the Obsidian Keystone once lay.
        </details>
        <details>
          <summary>üèõÔ∏è Oniron Archives</summary>
          Stacks of vellum. Librarians measure time by candle height.
        </details>
      </div>
      <div class="card">
        <h3>About this site</h3>
        <p>This is a single <strong>index.html</strong> you can drop into a GitHub Pages repo. No build tools, no dependencies.</p>
        <p>Want more pages later? Add <code>about.html</code> and link to it from the nav.</p>
      </div>
    </section>
  </main>

  <footer>
    <div class="container grid grid-2">
      <div>
        <small class="muted">¬© <span id="year"></span> Your Name. Crafted with HTML, CSS, and vanilla JS.</small>
      </div>
      <div style="justify-self:end">
        <a class="button" href="#top">Back to top</a>
      </div>
    </div>
  </footer>

  <script>
  // ===== Theme =====
  (function(){
    var root = document.documentElement;
    var t = document.getElementById('themeToggle');
    var saved = localStorage.getItem('theme');
    if (saved === 'light'){ root.classList.add('light'); if (t){ t.checked = true; } }
    if (t) t.addEventListener('change', function(){
      var isLight = !!t.checked;
      if (isLight) root.classList.add('light'); else root.classList.remove('light');
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    });
  })();

  // ===== Data (local) =====
  (function(){
    window.NAMES = {
      elf:["Elaith","Larethian","Faelar","Aeris","Sylvara","Thalanil","Nymeria","Aelar","Syllin","Vaelis"],
      dwarf:["Brom","Torunn","Hilda","Durik","Kazgrim","Brunhild","Rurik","Gimra","Thrain","Mavda"],
      human:["Alaric","Seraphine","Garrick","Rowan","Mira","Corvin","Elara","Tristan","Sabine","Dorian"],
      lizardfolk:["Sszark","Vresh","Thri'kash","Isskra","Zerith","Ressik","Sarraka","Kravax","Thozra","Vek"],
      orc:["Grom","Urga","Sharn","Vrusk","Magra","Thok","Zugra","Brakka","Orzul","Grishnak"]
    };
    window.LOCS = ["the Lantern Market","Wyrmwood Edge","the Ash Tunnels","the Oniron Archives","the Moonfen","Stormglass Cliffs","the Ember Docks"];
    window.MONSTERS = ["ember wraith","glass basilisk","moonfen lurker","ash-tunnel troll","wyrmwood stalker","stormglass harpy","lantern revenant"];
    window.VERBS = ["Hunt","Investigate","Protect","Recover","Escort","Disrupt","Track"];
    window.MEMENTOS = ["a soot-stained locket","a shard of black glass","a riverwarden badge","a lantern with cracked glass","a brass coin with a bite mark"];
    window.THREADS = ["a promise you failed to keep","a debt owed to the Ember Guild","a map fragment you can‚Äôt translate","dreams of ash and bells","a friend who never returned"];
    window.pick = function(a){ return a[Math.floor(Math.random()*a.length)]; };
  })();

  // ===== Quest filter =====
  (function(){
    var search = document.getElementById('questSearch');
    var list = document.getElementById('questList');
    if (!search || !list) return;
    search.addEventListener('input', function(){
      var q = (search.value || '').toLowerCase();
      var items = list.querySelectorAll('.quest-card');
      for (var i=0;i<items.length;i++){
        var li = items[i];
        var show = li.textContent.toLowerCase().indexOf(q) !== -1;
        li.style.display = show ? '' : 'none';
      }
    });
  })();

  // ===== Dice roller =====
  (function(){
    var output = document.getElementById('diceOutput');
    var countInput = document.getElementById('diceCount');
    var sidesInput = document.getElementById('diceSides');
    var lastTotal = null;
    if (!output || !countInput) return;
    function rollDie(s){ return Math.floor(Math.random()*s)+1; }
    function clamp(x,a,b){ return Math.max(a, Math.min(b,x)); }
    function roll(s){
      var n = parseInt(countInput.value || '1',10); if (isNaN(n)) n = 1; n = clamp(n,1,20);
      var rolls = [], total = 0;
      for (var i=0;i<n;i++){ var r = rollDie(s); rolls.push(r); total += r; }
      output.innerHTML = "<strong>"+n+"√ód"+s+"</strong>: "+rolls.join(", ")+" ‚Äî <strong>total "+total+"</strong>"+(lastTotal!==null?" (prev "+lastTotal+")":"");
      lastTotal = total;
    }
    var btns = document.querySelectorAll('.die');
    for (var i=0;i<btns.length;i++){
      (function(b){ b.addEventListener('click', function(){ roll(parseInt(b.getAttribute('data-sides'),10)); }); })(btns[i]);
    }
    document.addEventListener('keydown', function(e){
      var map = {'1':4,'2':6,'3':8,'4':10,'5':12,'6':20,'7':100};
      if (map[e.key]) roll(map[e.key]);
    });
    if (sidesInput) sidesInput.addEventListener('change', function(){ var s=parseInt(sidesInput.value,10); if (s>=2) roll(s); });
  })();

  // ===== Name forge (local) =====
  (function(){
    var race = document.getElementById('raceSelect');
    var btn = document.getElementById('genName');
    var out = document.getElementById('nameOut');
    if (!btn || !race || !out) return;
    btn.addEventListener('click', function(){
      var set = (window.NAMES && window.NAMES[race.value]) || window.NAMES.human;
      out.textContent = window.pick(set);
    });
  })();

  // ===== Local quest generator + manage (add/delete/persist) =====
  (function(){
    var list = document.getElementById('questList');
    var addBtn = document.getElementById('addQuestBtn');
    var input = document.getElementById('questInput');
    var randBtn = document.getElementById('genQuest');
    var rand3Btn = document.getElementById('genQuest3');
    var clearBtn = document.getElementById('clearQuestsBtn');
    if (!list) return;

    function attachDelButton(li){
      var b = document.createElement('button');
      b.className = 'quest-del';
      b.setAttribute('aria-label','Delete quest');
      b.title = 'Delete';
      b.textContent = '√ó';
      b.addEventListener('click', function(){ li.remove(); save(); });
      li.appendChild(b);
    }
    function save(){
      var arr = []; var items = list.querySelectorAll('li.quest-card');
      for (var i=0;i<items.length;i++){ arr.push(items[i].innerHTML); }
      try{ localStorage.setItem('quests_v1', JSON.stringify(arr)); }catch(e){}
    }
    function render(arr){
      list.innerHTML = '';
      for (var i=0;i<arr.length;i++){
        var li = document.createElement('li');
        li.className = 'quest-card';
        li.innerHTML = arr[i];
        attachDelButton(li);
        list.appendChild(li);
      }
    }
    function load(){
      var stored = null; try{ stored = JSON.parse(localStorage.getItem('quests_v1') || 'null'); }catch(e){}
      if (stored && Array.isArray(stored) && stored.length){ render(stored); }
      else {
        var items = list.querySelectorAll('li.quest-card');
        for (var i=0;i<items.length;i++){ attachDelButton(items[i]); }
        save();
      }
    }
    function addText(text){
      var t = (text||'').trim(); if (!t) return;
      var li = document.createElement('li'); li.className = 'quest-card';
      li.textContent = t; attachDelButton(li); list.prepend(li); save(); if (input) input.value='';
    }
    function randomQuest(){
      var verb = window.pick(window.VERBS);
      var mon = window.pick(window.MONSTERS);
      var place = window.pick(window.LOCS);
      var li = document.createElement('li'); li.className = 'quest-card';
      li.innerHTML = verb + ' a <strong>' + mon + '</strong> near <strong>' + place + '</strong>.';
      attachDelButton(li); list.prepend(li); save();
    }

    if (addBtn && input) addBtn.addEventListener('click', function(){ addText(input.value); });
    if (input) input.addEventListener('keydown', function(e){ if (e.key === 'Enter') addText(input.value); });
    if (randBtn) randBtn.addEventListener('click', randomQuest);
    if (rand3Btn) rand3Btn.addEventListener('click', function(){ randomQuest(); randomQuest(); randomQuest(); });
    if (clearBtn) clearBtn.addEventListener('click', function(){ if (confirm('Clear all quests?')){ list.innerHTML=''; save(); }});

    load();
  })();

  // ===== Local backstory generator =====
  (function(){
    var btn = document.getElementById('genBack');
    var out = document.getElementById('backOut');
    var race = document.getElementById('backRace');
    var klass = document.getElementById('backClass');
    if (!btn || !out) return;
    btn.addEventListener('click', function(){
      var m = window.pick(window.MEMENTOS);
      var t = window.pick(window.THREADS);
      var para = "You are a " + race.value.toLowerCase() + " " + klass.value.toLowerCase() +
        " who learned to read the wind along alley-rows and ash tunnels. You carry " + m +
        " and follow " + t + ". The Lantern Market remembers your name‚Äîwhether in whispers or in songs depends on what you do next.";
      out.textContent = para;
    });
  })();

  // ===== Misc =====
  (function(){
    var y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear();
    var anchors = document.querySelectorAll('a[href^="#"]');
    for (var i=0;i<anchors.length;i++){
      (function(a){
        a.addEventListener('click', function(e){
          var id = a.getAttribute('href').slice(1);
          var target = document.getElementById(id);
          if (target){ e.preventDefault(); target.scrollIntoView({behavior:'smooth', block:'start'}); target.classList.add('flash'); setTimeout(function(){target.classList.remove('flash');},600); }
        });
      })(anchors[i]);
    }
  })();
</script>
</body>
</html>
